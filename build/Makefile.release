# -*- mode: makefile -*-
CURRENT_DIR=$(shell pwd)
RELEASE_DIR=$(shell basename `pwd`)

restart:
	@if [ "$$(cd .. && pwd)" != "/home/pi" ]; then \
		echo "The release must be unpacked under /home/pi"; \
		exit 1; \
	fi
	sudo systemctl stop bespoke && \
	rm -f ../bespoke && \
	ln -sf $(CURDIR) $(CURDIR)/../bespoke && \
	sudo systemctl start bespoke

install:
	(cd target && $(MAKE) install && cd .. && $(MAKE) restart)
